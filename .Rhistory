phase_bb_k2 <- kfold(phase_betabinomial, K = 10, chains = 1)
end_time <- Sys.time
save.image("C:/Users/Wyandotte/Downloads/phase_bb_only.RData")
load("C:/Users/Wyandotte/Downloads/phase_bb_only.RData")
rm(list= ls()[!(ls() %in% c('phase','data','phase_betabinomial','phase_kfold', 'phase_bb_loo', 'phase_loo',
'phase_bb_ks'))])
rm(phase_loo)
rm(phase)
library(brms)
library(loo)
beta_binomial2 <- custom_family(
"beta_binomial2", dpars = c("mu", "phi"),
links = c("logit", "log"), lb = c(NA, 0),
type = "int", vars = "vint1[n]"
)
stan_funs <- "
real beta_binomial2_lpmf(int y, real mu, real phi, int T) {
return beta_binomial_lpmf(y | T, mu * phi, (1 - mu) * phi);
}
int beta_binomial2_rng(real mu, real phi, int T) {
return beta_binomial_rng(T, mu * phi, (1 - mu) * phi);
}
"
stanvars <- stanvar(scode = stan_funs, block = "functions")
summary(phase_betabinomial)
expose_functions(phase_betabinomial, vectorize = TRUE)
log_lik_beta_binomial2 <- function(i, prep) {
mu <- prep$dpars$mu[, i]
phi <- prep$dpars$phi
trials <- prep$data$vint1[i]
y <- prep$data$Y[i]
beta_binomial2_lpmf(y, mu, phi, trials)
}
phase_bb_k10 <- kfold(phase_betabinomial, K = 10, chains = 1)
save.image("C:/Users/Wyandotte/Downloads/phase_bb_only.RData")
library(rstanarm)
library(brms)
library(loo)
my_packages <- library()$results[,1]
head(my_packages, 10)
head(my_packages, 100)
head(my_packages, 1000)
(.packages())
phase_bb_k10 <- kfold(phase_betabinomial, K = 2, chains = 1)
load("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
library(brms)
library(tidyverse)
library(bayesplot)
funnel07 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==7),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_07 <- posterior_linpred(object = funnel07, newdata = newdata_tx, re_formula = NA)
linpred_bl_07 <- posterior_linpred(object = funnel07, newdata = newdata_bl, re_formula = NA)
linpred_es_07 <- linpred_tx_07 - linpred_bl_07
posterior_summary(linpred_es_07, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
funnel08 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==8),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_08 <- posterior_linpred(object = funnel08, newdata = newdata_tx, re_formula = NA)
linpred_bl_08 <- posterior_linpred(object = funnel08, newdata = newdata_bl, re_formula = NA)
linpred_es_08 <- linpred_tx_08 - linpred_bl_08
posterior_summary(linpred_es_08, robust = T)
funnel09 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==9),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_09 <- posterior_linpred(object = funnel09, newdata = newdata_tx, re_formula = NA)
linpred_bl_09 <- posterior_linpred(object = funnel09, newdata = newdata_bl, re_formula = NA)
linpred_es_09 <- linpred_tx_09 - linpred_bl_09
posterior_summary(linpred_es_09, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
funnel10 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==10),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_10 <- posterior_linpred(object = funnel10, newdata = newdata_tx, re_formula = NA)
linpred_bl_10 <- posterior_linpred(object = funnel10, newdata = newdata_bl, re_formula = NA)
linpred_es_10 <- linpred_tx_10 - linpred_bl_10
posterior_summary(linpred_es_10, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
funnel11 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==11),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_11 <- posterior_linpred(object = funnel11, newdata = newdata_tx, re_formula = NA)
linpred_bl_11 <- posterior_linpred(object = funnel11, newdata = newdata_bl, re_formula = NA)
linpred_es_11 <- linpred_tx_11 - linpred_bl_11
posterior_summary(linpred_es_11, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
funnel12 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==12),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_12 <- posterior_linpred(object = funnel12, newdata = newdata_tx, re_formula = NA)
linpred_bl_12 <- posterior_linpred(object = funnel12, newdata = newdata_bl, re_formula = NA)
linpred_es_12 <- linpred_tx_12 - linpred_bl_12
posterior_summary(linpred_es_12, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
funnel13 <- update(object = funnel01,
newdata = data_funnel[which(data_funnel$Study==13),],
control = list(adapt_delta = .999),
iter = 5000,
chains = 4,
cores = 4,
seed = 12345)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
linpred_tx_13 <- posterior_linpred(object = funnel13, newdata = newdata_tx, re_formula = NA)
linpred_bl_13 <- posterior_linpred(object = funnel13, newdata = newdata_bl, re_formula = NA)
linpred_es_13 <- linpred_tx_13 - linpred_bl_13
posterior_summary(linpred_es_13, robust = T)
save.image("C:/Users/Wyandotte/Downloads/TUF funnel plot.RData")
ppred_tx_01 <- posterior_predict(object = funnel01, newdata = newdata_tx, re_formula = NA)
ppred_bl_01 <- posterior_predict(object = funnel01, newdata = newdata_bl, re_formula = NA)
ppred_es_01 <- ppred_tx_01 - linpred_bl_01
ppred_tx_04 <- posterior_predict(object = funnel04, newdata = newdata_tx, re_formula = NA)
ppred_bl_04 <- posterior_predict(object = funnel04, newdata = newdata_bl, re_formula = NA)
ppred_es_04 <- ppred_tx_04 - linpred_bl_04
ppred_tx_05 <- posterior_predict(object = funnel05, newdata = newdata_tx, re_formula = NA)
ppred_bl_05 <- posterior_predict(object = funnel05, newdata = newdata_bl, re_formula = NA)
ppred_es_05 <- ppred_tx_05 - linpred_bl_05
ppred_tx_06 <- posterior_predict(object = funnel06, newdata = newdata_tx, re_formula = NA)
ppred_bl_06 <- posterior_predict(object = funnel06, newdata = newdata_bl, re_formula = NA)
ppred_es_06 <- ppred_tx_06 - linpred_bl_06
posterior_summary(ppred_es_06)
posterior_summary(ppred_bl_06)
posterior_summary(ppred_tx_06)
ppred_es_06 <- ppred_tx_06 - ppred_bl_06
posterior_summary(ppred_es_06)
View(newdata_bl)
ppred_tx_04 <- posterior_predict(object = funnel04, newdata = newdata_tx, re_formula = NA)
ppred_bl_04 <- posterior_predict(object = funnel04, newdata = newdata_bl, re_formula = NA)
ppred_s_04 <- ppred_tx_04 - ppred_bl_04
posterior_summary(ppred_es_04)
ppred_tx_04 <- posterior_predict(object = funnel04, newdata = newdata_tx, re_formula = NA)
ppred_bl_04 <- posterior_predict(object = funnel04, newdata = newdata_bl, re_formula = NA)
ppred_s_04 <- ppred_tx_04 - ppred_bl_04
posterior_summary(ppred_es_04)
posterior_summary(ppred_bl_04)
posterior_summary(ppred_tx_04)
posterior_summary(ppred_es_04)
ppred_es_04 <- ppred_tx_04 - ppred_bl_04
posterior_summary(ppred_es_04)
posterior_summary(ppred_es_04)
posterior_summary(ppred_bl_06)
posterior_summary(ppred_es_06)
ppred_tx_08 <- posterior_predict(object = funnel08, newdata = newdata_tx, re_formula = NA)
ppred_bl_08 <- posterior_predict(object = funnel08, newdata = newdata_bl, re_formula = NA)
ppred_es_08 <- ppred_tx_08 - ppred_bl_08
posterior_summary(ppred_es_13)
ppred_tx_13 <- posterior_predict(object = funnel13, newdata = newdata_tx, re_formula = NA)
ppred_bl_13 <- posterior_predict(object = funnel13, newdata = newdata_bl, re_formula = NA)
ppred_es_13 <- ppred_tx_13 - ppred_bl_13
posterior_summary(ppred_es_13)
ppred_es_13 <- ppred_tx_13 - ppred_bl_13
posterior_summary(ppred_es_08)
ppred_tx_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_tx, re_formula = NA),lb = 0,ub = 20)
ppred_tx_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_tx, re_formula = NULL),lb = 0,ub = 20)
ppred_tx_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_tx, re_formula = NA),lb = 0,ub = 20)
ppred_bl_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_bl, re_formula = NA,lb = 0,ub = 20))
ppred_es_08 <- ppred_tx_08 - ppred_bl_08
posterior_summary(ppred_es_08)
ppred_tx_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_tx, re_formula = NA)+.5,lb = 0,ub = 20)
ppred_bl_08 <- logit_scaled(posterior_predict(object = funnel08, newdata = newdata_bl, re_formula = NA,lb = 0,ub = 20))
View(fp)
View(funnel03)
load("C:/Users/Wyandotte/Downloads/phase_bb_kf.RData")
phase_betabinomial
load("C:/Users/Wyandotte/Downloads/phase_olre_v_bb_kf.RData")
loo_compare(phase_kfold,phase_bb_k10)
library(brms)
library(tidyverse)
library(bayesplot)
library(loo)
loo_compare(phase_kfold,phase_bb_k10)
pp_check(phase_betabinomial, nsamples = 100, type = "bars")
posterior_predict_beta_binomial2 <- function(i, prep, ...) {
mu <- prep$dpars$mu[, i]
phi <- prep$dpars$phi
trials <- prep$data$vint1[i]
beta_binomial2_rng(mu, phi, trials)
}
posterior_predict_beta_binomial2 <- function(i, prep, ...) {
mu <- prep$dpars$mu[, i]
phi <- prep$dpars$phi
trials <- prep$data$vint1[i]
beta_binomial2_rng(mu, phi, trials)
}
phase_betabinomial
log_lik_beta_binomial2 <- function(i, prep) {
mu <- prep$dpars$mu[, i]
phi <- prep$dpars$phi
trials <- prep$data$vint1[i]
y <- prep$data$Y[i]
beta_binomial2_lpmf(y, mu, phi, trials)
}
load("C:/Users/Wyandotte/Downloads/phase_olre_v_bb_kf.RData")
load("C:/Users/Wyandotte/Downloads/TUF funnel plot 04.RData")
library(brms)
library(tidyverse)
library(bayesplot)
post_draws_phase <- ranef(object = phase,summary = F)$SubjectCode[,,3] + mean(fixef(object = phase,summary = F)[,3])
post_draws_sc <- ranef(object = phase,summary = F)$SubjectCode[,,4] + mean(fixef(object = phase,summary = F)[,4])
post_draws_es <- post_draws_phase + post_draws_sc
mean(post_draws_es)
post_draws_es_01 <- rowMeans(post_draws_es[,1:4])
post_draws_es_02 <- rowMeans(post_draws_es[,5:9])
post_draws_es_03 <- rowMeans(post_draws_es[,10:11])
post_draws_es_04 <- rowMeans(post_draws_es[,12:18])
post_draws_es_05 <- rowMeans(post_draws_es[,19:21])
post_draws_es_06 <- post_draws_es[,22]
post_draws_es_07 <- rowMeans(post_draws_es[,23:24])
post_draws_es_08 <- post_draws_es[,25]
post_draws_es_09 <- rowMeans(post_draws_es[,26:29])
post_draws_es_10 <- rowMeans(post_draws_es[,30:33])
post_draws_es_11 <- rowMeans(post_draws_es[,34:35])
post_draws_es_12 <- rowMeans(post_draws_es[,36:40])
post_draws_es_13 <- rowMeans(post_draws_es[,41:46])
fp02 <- data.frame(rbind(posterior_summary(post_draws_es_01)[,1:2],
posterior_summary(post_draws_es_02)[,1:2],
posterior_summary(post_draws_es_03)[,1:2],
posterior_summary(post_draws_es_04)[,1:2],
posterior_summary(post_draws_es_05)[,1:2],
posterior_summary(post_draws_es_06)[,1:2],
posterior_summary(post_draws_es_07)[,1:2],
posterior_summary(post_draws_es_08)[,1:2],
posterior_summary(post_draws_es_09)[,1:2],
posterior_summary(post_draws_es_10)[,1:2],
posterior_summary(post_draws_es_11)[,1:2],
posterior_summary(post_draws_es_12)[,1:2],
posterior_summary(post_draws_es_13)[,1:2]))
fp02$n <- fp$n
pl
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(-2.5,2.5),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(mean(post_draws_es),mean(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+.0069,-0.784+.0069)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+.0069,0.784+.0069)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
-2.5+3.94
2.5+3.94
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(-1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(mean(post_draws_es),mean(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(mean(post_draws_es),mean(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
hist(post_draws_es)
ks.test(post_draws_es)
ks.test(x = post_draws_es, y = pnorm)
library(moments)
skewness(post_draws_es)
kurtosis(post_draws_es)
hist(fp02$Estimate)
hist(post_draws_es_01)
ks.test(post_draws_es_01, pnorm)
fp02 <- data.frame(rbind(posterior_summary(post_draws_es_01, robust = T)[,1:2],
posterior_summary(post_draws_es_02, robust = T)[,1:2],
posterior_summary(post_draws_es_03, robust = T)[,1:2],
posterior_summary(post_draws_es_04, robust = T)[,1:2],
posterior_summary(post_draws_es_05, robust = T)[,1:2],
posterior_summary(post_draws_es_06, robust = T)[,1:2],
posterior_summary(post_draws_es_07, robust = T)[,1:2],
posterior_summary(post_draws_es_08, robust = T)[,1:2],
posterior_summary(post_draws_es_09, robust = T)[,1:2],
posterior_summary(post_draws_es_10, robust = T)[,1:2],
posterior_summary(post_draws_es_11, robust = T)[,1:2],
posterior_summary(post_draws_es_12, robust = T)[,1:2],
posterior_summary(post_draws_es_13, robust = T)[,1:2]))
fp02$n <- fp$n
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
fp02 <- data.frame(rbind(posterior_summary(post_draws_es_01, robust = T)[,1:4],
posterior_summary(post_draws_es_02, robust = T)[,1:4],
posterior_summary(post_draws_es_03, robust = T)[,1:4],
posterior_summary(post_draws_es_04, robust = T)[,1:4],
posterior_summary(post_draws_es_05, robust = T)[,1:4],
posterior_summary(post_draws_es_06, robust = T)[,1:4],
posterior_summary(post_draws_es_07, robust = T)[,1:4],
posterior_summary(post_draws_es_08, robust = T)[,1:4],
posterior_summary(post_draws_es_09, robust = T)[,1:4],
posterior_summary(post_draws_es_10, robust = T)[,1:4],
posterior_summary(post_draws_es_11, robust = T)[,1:4],
posterior_summary(post_draws_es_12, robust = T)[,1:4],
posterior_summary(post_draws_es_13, robust = T)[,1:4]))
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(2.07,2.36)
lby <- c(.98,.45)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(4.58,7.06)
uby <- c(.98,.45)
lines(x = ubx, y = uby, lty = 2)
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(2.07,2.36)
lby <- c(.98,.45)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(4.58,7.06)
uby <- c(.45,.98)
lines(x = ubx, y = uby, lty = 2)
fp02 <- data.frame(rbind(posterior_summary(post_draws_es_01, robust = F)[,1:4],
posterior_summary(post_draws_es_02, robust = F)[,1:4],
posterior_summary(post_draws_es_03, robust = F)[,1:4],
posterior_summary(post_draws_es_04, robust = F)[,1:4],
posterior_summary(post_draws_es_05, robust = F)[,1:4],
posterior_summary(post_draws_es_06, robust = F)[,1:4],
posterior_summary(post_draws_es_07, robust = F)[,1:4],
posterior_summary(post_draws_es_08, robust = F)[,1:4],
posterior_summary(post_draws_es_09, robust = F)[,1:4],
posterior_summary(post_draws_es_10, robust = F)[,1:4],
posterior_summary(post_draws_es_11, robust = F)[,1:4],
posterior_summary(post_draws_es_12, robust = F)[,1:4],
posterior_summary(post_draws_es_13, robust = F)[,1:4]))
fp02$n <- fp$n
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
posterior_summary(post_draws_es)
posterior_summary(post_draws_es, robust = T)
bysubj_es_summary_robust <- posterior_summary(post_draws_es, robust = T)
fp02$medians <- bysubj_es_summary_robust[,1]
fp02$sd[1] <- sd(bysubj_es_summary_robust[1:4,1])
fp02$sd[1]
fp02$sd[1] <- sd(bysubj_es_summary_robust[1:4,1])
fp02$sd[2] <- sd(bysubj_es_summary_robust[5:9,1])
fp02$sd[3] <- sd(bysubj_es_summary_robust[10:11,1])
fp02$sd[4] <- sd(bysubj_es_summary_robust[12:18,1])
fp02$sd[5] <- sd(bysubj_es_summary_robust[19:21,1])
fp02$sd[6] <- sd(bysubj_es_summary_robust[22,1])
fp02$sd[7] <- sd(bysubj_es_summary_robust[23:24,1])
fp02$sd[8] <- sd(bysubj_es_summary_robust[25,1])
fp02$sd[9] <- sd(bysubj_es_summary_robust[26:29,1])
fp02$sd[10] <- sd(bysubj_es_summary_robust[30:33,1])
fp02$sd[11] <- sd(bysubj_es_summary_robust[34:35,1])
fp02$sd[12] <- sd(bysubj_es_summary_robust[36:40,1])
fp02$sd[13] <- sd(bysubj_es_summary_robust[41:46,1])
fp02$se.mean <- fp02$sd / sqrt(fp02$n)
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(-2.5,2.5))
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(1.44,6.44))
plot(fp02$sd,fp02$n)
sd(bysubj_es_summary_robust[,1])
fp02$sd[6] <- .61
fp02$sd[7] <- sd(bysubj_es_summary_robust[23:24,1])
fp02$sd[8] <- .61
fp02$se.mean <- fp02$sd / sqrt(fp02$n)
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(1.44,3.44))
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(1.44,6.44))
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(1.44,6.44), ylim = rev(c(0,.7)))
cor.test(fp02$Estimate,fp02$n)
plot(fp02$se.mean,fp02$n)
plot(x = fp02$Estimate, y = fp02$se.mean,xlim = c(1.44,6.44), ylim = rev(c(0,.7)))
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
sqrt(10000)
cor.test(fp02$Est.Error,fp02$n)
phase
fp02$prec <- 1/fp02$Est.Error
fp02$d <- fp02$Estimate/fp02$Est.Error
egger_test <- brm(d ~ prec, data = fp02)
egger_test <- brm(d ~ prec, data = fp02, cores = 4)
egger_test
posterior_samples(x = egger_test, pars = 'Intercept')
mean(posterior_samples(x = egger_test, pars = 'Intercept'))
mean(posterior_samples(x = egger_test, pars = 'Intercept')na.rm = T)
mean(posterior_samples(x = egger_test, pars = 'Intercept'),na.rm = T)
mean(posterior_samples(x = egger_test, pars = 'Intercept'),na.rm = T)
str(posterior_samples(x = egger_test, pars = 'Intercept'))
fp_int <- posterior_samples(x = egger_test, pars = 'Intercept')
mean(fp_int)
View(fp_int)
mean(fp_int$b_Intercept)
mean(fp_int$b_Intercept>0)
plot(x = fp02$d, y = fp02$prec)
plot(y = fp02$d, x = fp02$prec)
plot(y = fp02$d, x = fp02$n)
plot(x = fp02$d, y = fp02$prec)
plot(y = fp02$d, x = fp02$prec)
plot(y = fp02$d, x = fp02$prec, ylim = c(0,8), xlim = c(0,8))
lines(x = c(0,6), y = c(0,6))
egger_test
plot(x = fp02$d, y = fp02$prec)
plot(y = fp02$d, x = fp02$prec, ylim = c(0,8), xlim = c(0,8))
?lines
lines(x = c(0,8), y = c(.94, .94+3.17+8))
plot(y = fp02$d, x = fp02$prec, ylim = c(0,8), xlim = c(0,8))
lines(x = c(0,8), y = c(.94, .94+3.17*8))
lines(x = c(-1,8), y = c(.94-3.17, .94+3.17*8))
mean(fp_int$b_Intercept>0)
plot(x = fp02$d, y = fp02$prec)
plot(x = fp02$d, y = fp02$n)
plot(x = fp02$d, y = fp02$prec)
summary(lm(d ~ prec, data = fp02))
hist(fp_int$b_Intercept)
mean(fp_int$b_Intercept>0)
1-.854
.146*2
egger_test
summary(egger_test, prob = .9)
plot(x = fp02$Estimate, y = fp02$Est.Error, ylim = rev(c(0.4,1.4)), xlim = c(1.44,6.44),
xlab = "Mean Effect Size by Study in Log Odds", ylab = "Posterior Standard Deviation")
lines(x = c(median(post_draws_es),median(post_draws_es)), y = c(.4,1.25))
# 1.2*1.96
# .4*1.96
lbx <- c(-2.35+3.94,-0.784+3.94)
lby <- c(1.2,.4)
lines(x = lbx, y = lby, lty = 2)
ubx <- c(2.35+3.94,0.784+3.94)
uby <- c(1.2,.4)
lines(x = ubx, y = uby, lty = 2)
plot(x = fp02$Estimate, y = fp02$n,xlim = c(1.44,6.44), ylim = rev(c(0,8)))
plot(x = fp02$Estimate, y = fp02$n,xlim = c(1.44,6.44), ylim = c(0,8))
cor.test(fp02$Estimate,fp02$Est.Error)
cor.test(fp02$prec,fp02$d)
setwd("~/bayotas bphil/Bayotas/github")
load("~/bayotas bphil/hula_bayotas_output_2021-07-29.RData")
chg_full_gen <- eap_postx_fullpnt_gen - eap_pretx_fullpnt
eap_pretx_pntcat <- pretx_pntcat$cat_theta
eap_pretx_fullpnt <- pretx_pntcat$tot_theta
eap_postx_pntcat_gen <- postx_pntcat_gen$cat_theta
eap_postx_fullpnt_gen <- postx_pntcat_gen$tot_theta
eap_postx_pntcat_spec <- postx_pntcat_spec$cat_theta
eap_postx_fullpnt_spec <- postx_pntcat_spec$tot_theta
load("/Users/pauline/Documents/Bayotas/simresp_pretx.RData")
load("/Users/pauline/Documents/Bayotas/theta_sim.RData")
# simulate pre-treatment responses to the PNT
simresp_pretx <- simIrt( theta = theta_sim, params = itpar_pnt[,1:3], mod = c("brm") )
library(sn)
library(catIrt)
library(catR)
# simulate pre-treatment responses to the PNT
simresp_pretx <- simIrt( theta = theta_sim, params = itpar_pnt[,1:3], mod = c("brm") )
View(best_cond_1_cat30)
